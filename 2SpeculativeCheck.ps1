if ($PSVersionTable.PSVersion.Major -gt 4 ){
install-module SpeculationControl
# Save the current execution policy so it can be reset

$SaveExecutionPolicy = Get-ExecutionPolicy

Set-ExecutionPolicy RemoteSigned -Scope Currentuser

Import-Module SpeculationControl

Get-SpeculationControlSettings

# Reset the execution policy to the original state

Set-ExecutionPolicy $SaveExecutionPolicy -Scope Currentuser
}else {
    #If Powershell version less than 5
if ($PSVersionTable.PSVersion.Major -lt 5 ){
    $wmf = "c:\temp\wmf5.1.msu"
    $web = New-Object -TypeName System.Net.WebClient
    switch ([System.Environment]::OSVersion.Version.Build) {
        
    9200 {
        switch ([System.Environment]::OSVersion.Version.Minor) {
            3 { 
                Write-Host "build is 2.9200 AKA windows server 2012 or windows 8 installing KB4056899"
                $wmfURL ="https://go.microsoft.com/fwlink/?linkid=839513"
                $web.DownloadFile($wmfURL,$wmf)
                }

            2 {
                    Write-Host "build is 3.9200 AKA windows server 2012 R2 or Windows 8.1 installing KB4056898" 
                    $wmfURL ="https://go.microsoft.com/fwlink/?linkid=839516"
                    $web.DownloadFile($wmfURL,$wmf)
}
            Default {}
        }
        }

        7601 {
            Write-Host "build is 7601 AKA windows server 2008 R2 SP1 or windows 7 SP1 installing KB4056897" 
            $wmfURL ="https://go.microsoft.com/fwlink/?linkid=839523"
            $web.DownloadFile($wmfURL,$wmf.zip)
            }
    Default {}
    
        }
    }
 
}